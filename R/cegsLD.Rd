\name{cegsLD}
\alias{cegsLD}
\title{
The compound exponential-geometric series fit by likelihood differencing
}
\description{
Uses likelihood differencing to fit a species abundance distribution to the compound exponential-geometric series.
}
\usage{
cegsLD(n)
}
\arguments{
  \item{n}{
A vector of integer counts representing the number of individuals per species.
}
}
\details{
This function fits the compound exponential-geometric series (CEGS) distribution, returning the corrected Akaike information criterion (AICc) fit statistic and the rank and species abundance distributions in addition to estimated richness and the distribution's two governing parameters.

CEGS assumes each count is generated by a random draw from the geometric series (GS), but with the governing parameter \emph{p} of the GS being itself a function of a random exponential variate \emph{E} = -log(\emph{U}), where \emph{U} is uniformly distributed between 0 and 1. In other words, each count is doubly random. The expression is fitted to data by varying a scale term \eqn{\lambda} and a shape term \eqn{\gamma}, which feature in the probability mass function at different points.

Further details that include the derivation of the compound distribution are given on the \link{cegsML} manual page.

Like the \link{cegsB} Bayesian version, the likelihood differencing calculation of CEGS makes use of all likelihood values. Unlike any Bayesian calculation, it does not use a prior distribution. Instead, it takes averages of parameter values across a grid point-sampled likelihood surface. The averages are weighted by differences between neighbouring likelihoods. Because doubling the grid point density halves the differences, the method is essentially insensitive to the spatial arrangement of sampling points. By implication, it does not assume a prior distribution.

The likelihoods are joint probabilities of the count distributions given possible combinations of the parameters (i.e., the conditional probabilities). The examined \eqn{\lambda} and \eqn{\gamma} values are each based on a series of 51 points ranging from nearly zero to 51. It is generated by taking an odds ratio, specifically meaning 52/1:51 - 1.

After computing a likelihood matrix for each combination, the matrix is differenced in both directions once horizontally and once vertically. The differenced matrices are cross-multiplied and then scaled to add up to 1. Averaged values of \eqn{\lambda} and \eqn{\gamma} are found simply by multiplying each candidate vector by the weighted matrix and summing.

An AICc is also reported for comparability with other functions. \link{cegsML} will produce lower AICcs if a likelihood approach is preferred. The likelihood calculation that yields the AICc is explained in the package details.

Like \link{cegsB}, \emph{cegsLD} produces species richness estimates with low variance because it takes all likelihoods into account. However, \emph{cegsLD} does not assume a prior distribution (see the above). \link{cegsML} is faster than either one.

The function \link{rcegs} computes random integers based on the distribution.
}
\value{
  \item{richness}{The sample's estimated species richness.}
  \item{scale}{The estimated \eqn{\lambda} (scale) parameter of the CEGS distribution.}
  \item{shape}{The estimated \eqn{\gamma} (shape) parameter of the CEGS distribution.}
  \item{AICc}{The corrected Akaike information criterion value computed from the log likelihood.}
  \item{fitted.RAD}{The predicted rank abundance distribution.}
  \item{fitted.SAD}{The predicted species abundance distribution.}
}
\author{
John Alroy
}
\examples{
# CEGS distribution
n <- rcegs(100)
cegsLD(n[n > 0])$richness

# Poisson log normal distribution
n <- rpois(100,exp(rnorm(100,sd=2)))
cegsLD(n[n > 0])$richness

# scaled odds distribution
n <- rodds(100,1)
cegsLD(n[n > 0])$richness
}
